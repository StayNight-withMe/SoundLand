<UserControl x:Class="test.SongTabControl.MainSongTab"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	         
		>
	<UserControl.Resources>
		
	</UserControl.Resources>
	       

	
		
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="19*"/>
            <ColumnDefinition Width="173*"/>
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition Height="0.7*" /> <!-- Верх: поиск -->
            <RowDefinition Height="0.5*" /> <!-- Под поиском: возможно, отступ -->
            <RowDefinition Height="7*" />   <!-- Основной список треков -->
            <RowDefinition Height="*" />    <!-- Нижняя панель: плеер -->
        </Grid.RowDefinitions>

  
        <Grid VerticalAlignment="Center" Grid.Row="0" Grid.ColumnSpan="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="7*"/>
                <ColumnDefinition Width="1*"/>
            </Grid.ColumnDefinitions>

            <TextBox x:Name="SearchBox"
                     Grid.Column="0"
                     VerticalAlignment="Center"
                     Height="30"
                     Text="{Binding InputText, UpdateSourceTrigger=PropertyChanged}"
                     Style="{StaticResource RoundedTextBoxStyle}"
                     HorizontalAlignment="Stretch"
                     Margin="0,0,10,0"/>

            <Button x:Name="SearchBtn"
                    Grid.Column="1"
                    HorizontalContentAlignment="Center"
                    VerticalContentAlignment="Center"
                    FontSize="20"
                    Content="поиск"
                    Width="100"
                    Height="35"
                    Style="{StaticResource ButtonStyle}"
                    Padding="0"
                    Command="{Binding SearchSong}"/>
        </Grid>


        <Popup x:Name="PopupPlaylist" IsOpen="{Binding PopupIsOpen}" Placement="Right" Height="200" Width="200" Grid.Row="0" Grid.ColumnSpan="2">
            <Border Background="Transparent">
                <Grid>

                    <Grid.RowDefinitions>
                        <RowDefinition Height="2*" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>


                    <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Center">

                        <Button Content="добавить" Command="{Binding AddToPlayList}" CommandParameter="{Binding}" Background="Gray" FontSize="15"  Foreground="White"/>

                        <Button Content="Отмена" Background="Gray" Command="{Binding СancelPopup}" CommandParameter="{Binding}" FontSize="15" Foreground="White" />

                        </StackPanel>

                            

                    <ListView BorderThickness="0" Grid.Row="0" SelectedItem="{Binding SelectedPlayList, Mode=TwoWay}" x:Name="PlayListVieaw1" Background="Black" ItemsSource="{Binding Collections.PlayLists}">
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <Border BorderBrush="Transparent" BorderThickness="0,0,0,1">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="1" Text="{Binding Name}" FontWeight="Bold" FontSize="16"
                                                   HorizontalAlignment="Left" VerticalAlignment="Center" Foreground="White"
                                                   Margin="10,0"/>
                                        

                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </Grid>
            </Border>
        </Popup>


        <ListView x:Name="TracksListView"
                  Grid.Row="2" 
                  Grid.ColumnSpan="2"
                  BorderThickness="0"
                  Margin="0,10,0,10"
                  ItemsSource="{Binding Collections.Tracks}"
                  ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                  SelectedItem="{Binding SelectedTrack, Mode=TwoWay}"
                  SelectionMode="Single"
                  ScrollViewer.VerticalScrollBarVisibility="Auto"
                  ScrollViewer.CanContentScroll="False"
                  Background="Transparent">
            <ListView.ItemTemplate>
                <DataTemplate>
                    <Border BorderBrush="Transparent" BorderThickness="0,0,0,1" Padding="10">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <Image Source="{Binding ImageData}" Width="50" Height="50" Margin="10,0,10,0"/>
                            <StackPanel Grid.Column="1">
                                <TextBlock Text="{Binding Name}" FontWeight="Bold" FontSize="16" HorizontalAlignment="Left"/>
                                <TextBlock Text="{Binding Artist}" Foreground="#555" FontSize="14"/>
                            </StackPanel>
                            <TextBlock Grid.Column="2" Text="{Binding Duration}" Margin="10,18,10,10" VerticalAlignment="Center" FontSize="14"/>
                            <StackPanel Grid.Column="3" HorizontalAlignment="Right" Orientation="Horizontal">
                                <Button Content="+" Background="Black" Height="25" Width="25" Foreground="White" Padding="0"/>
                                <Button Content="в все треки" Width="100" Height="25" Foreground="White"         Command="{Binding DataContext.ToALLTrack, RelativeSource={RelativeSource AncestorType=UserControl}}" 
        CommandParameter="{Binding}"    Background="Black" Padding="0" Margin="10,0,0,0"/>
                                <Button Content="в плейлист" Width="100" Height="25" Background="Black" Foreground="White" Padding="0" Margin="10,0,30,0"
                                        Command="{Binding DataContext.ToPlayList, RelativeSource={RelativeSource AncestorType=UserControl}}" 
        CommandParameter="{Binding}"  
                                        />
                            </StackPanel> 
                        </Grid>
                    </Border>
                </DataTemplate>
            </ListView.ItemTemplate>
            <ListView.ItemContainerStyle>
                <Style TargetType="{x:Type ListViewItem}">
                    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="{x:Type ListViewItem}">
                                <Border x:Name="Bd" BorderBrush="Transparent" BorderThickness="0" Background="Transparent"
                                        Padding="{TemplateBinding Padding}" SnapsToDevicePixels="true">
                                    <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                      VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" TargetName="Bd" Value="Transparent"/>
                                    </Trigger>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" TargetName="Bd" Value="Transparent"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </ListView.ItemContainerStyle>
        </ListView>

        <Grid Grid.Row="3" Grid.ColumnSpan="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="0.7*"/>
                <ColumnDefinition Width="6*"/>
                <ColumnDefinition Width="0.5*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Button x:Name="PlayPauseBtn" Content="{Binding PlayPauseButtonText}" Command="{Binding PlayPause}" Style="{StaticResource ButtonStyle}"
                    Height="50" Width="50" Grid.Column="1"
                    HorizontalAlignment="Left"/>

            <MediaElement x:Name="MediaPlayer" Visibility="Collapsed"
                          LoadedBehavior="Manual" Source="{Binding SourceForMediaElement}" Volume="{Binding ElementName=slider, Path=Value}" UnloadedBehavior="Stop"/>

            <Image x:Name="PlaySong" Width="70" Grid.Column="0" HorizontalAlignment="Left" Margin="30,0,0,0"  Source="{Binding Image}" Height="60"/>

            <Slider x:Name="ProgressBar"  IsMoveToPointEnabled="True" Value="{Binding SongSliderValue, Mode=TwoWay}"
 Style="{StaticResource CustomSliderStyle}" Background="Transparent" Foreground="Black"
                         HorizontalAlignment="Stretch" VerticalAlignment="Center"  
                         Margin="10,0,20,10" Minimum="0" Maximum="100" Grid.Column="2" Height="10" IsEnabled="True"/>

            <TextBlock x:Name="Duration" Text="00:00" Foreground="Black" Grid.Column="3" HorizontalAlignment="Right" Margin="0,30,0,0" FontSize="16"/>

            <Slider x:Name="slider" IsMoveToPointEnabled="True"
 Style="{StaticResource CustomSliderStyle}"
                    Height="30" Width="100" HorizontalAlignment="Right" Margin="0,0,10,0"
                    Minimum="0" Maximum="1" Value="{Binding ElementName=MediaPlayer, Path=Volume}"
                    Background="Transparent" Foreground="Black" BorderBrush="Black" Grid.Column="4"/>
        </Grid>
    </Grid>
</UserControl>